extends ../layouts/main.pug

block content
  .container
    header
      h3= "Chat: " + name

    div 
      h6 Participants:
      each author in authors
        p=author.email

      form(action="/chats/addnewparticipant", method = "POST")
        .form-group
          label Add participant by email 
          input.form-control(name="email", required)
          input(type="hidden", name="chat_id", value=chat_id)
        .form-group
          button.btn.btn-dark(type="submit") Submit
    hr
    div
      table.table.table-striped
        thead
          tr
            th Who?
            th Said what?
            th When?
        
        tbody
          each message in messages
            tr
              td= message.author.email
              td= message.content
              td= message.updatedAt
    hr
    div
      form(action="/chats/addnewmessage", method = "POST")
        .form-group
          label Enter your message 
          input.form-control(name="message[text]", required)
          input(type="hidden", name="message[chat_id]", value=chat_id)
        .form-group
          button.btn.btn-dark(type="submit") Submit
    hr
    div
      form(action="/chats/leavechat", method = "POST", onsubmit='return confirm("Are you sure?");')
        .form-group
          input(type="hidden", name="leave[chat_id]", value=chat_id)
        .form-group
          button.btn.btn-danger(type="submit") Leave Chat
